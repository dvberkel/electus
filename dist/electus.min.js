/*! electus - v0.0.0 - 2012-12-05
* https://github.com/dvberkel/electus
* Copyright (c) 2012 Daan van Berkel; Licensed MIT */
(function(e){"use strict";e.Electus={version:"0.0.0"}})(window?window:module.exports),function(e,t,n,r,i){var s=n.Model.extend({initialize:function(){this.has("sentence")||this.set("sentence",new r.Sentence({text:"You should come prepared"})),this.has("after-agreement")||this.set("after-agreement",[]),this.on("change:agreement",function(){t.each(this.get("after-agreement"),function(e){e.call(this)})},this),this.get("sentence").on("change:text",function(){this.refresh()},this)},refresh:function(){this.set("agreement",i)},agree:function(){this.set("agreement",!0)},disagree:function(){this.set("agreement",!1)},setSentence:function(e){this.get("sentence").set("text",e)}}),o=n.View.extend({initialize:function(){this.render()},render:function(){var t=e("<div class='statement'></div>");new r.SentenceView({model:this.model.get("sentence"),el:t}),new u({model:this.model,el:t}),new a({model:this.model,el:t}),t.appendTo(this.$el)}}),u=n.View.extend({initialize:function(){this.model.on("change:agreement",function(){this.model.get("agreement")===i?e("button.agree, button.disagree").show():e("button.agree, button.disagree").hide()},this),this.render()},render:function(){var e=this,t=this.button();t.click(function(){e.model.agree()}),t.appendTo(e.$el)},button:function(){return this._button===i&&(this._button=e("<button class='agree btn btn-large btn-success'>agree</button>")),this._button}}),a=n.View.extend({initialize:function(){this.model.on("change:agreement",function(){this.model.get("agreement")===i?e("button.agree, button.disagree").show():e("button.agree, button.disagree").hide()},this),this.render()},render:function(){var e=this,t=this.button();t.click(function(){e.model.disagree()}),t.appendTo(e.$el)},button:function(){return this._button===i&&(this._button=e("<button class='disagree btn btn-large btn-danger'>disagree</button>")),this._button}});r.Statement=s,r.StatementView=o}(jQuery,_,Backbone,Electus),function(e,t,n,r){var i=n.Model.extend({defaults:{text:"Empty sentence"},initialize:function(){this.has("after-send")||this.set("after-send",[])},send:function(){var e=this;t.each(this.get("after-send"),function(t){t.call(e)})}}),s=n.Collection.extend({model:i,initialize:function(e){e=e||{},e["after-send"]?this["after-send"]=e["after-send"]:this["after-send"]=[]},addAll:function(e){this.reset();var n=e.split(";"),r=this;t.each(n,function(e){var t=new i({text:e,"after-send":[function(){r.send(this)}]});this.add(t)},this)},send:function(e){t.each(this["after-send"],function(t){t.call(e)})}}),o=n.View.extend({initialize:function(){this.model.on("change:text",this.render,this),this.render()},render:function(){var e=this.span();e.text(this.model.get("text"))},span:function(){return this._span||(this._span=e("<h1 class='sentence'>?</h1>"),this._span.appendTo(this.$el)),this._span}}),u=n.View.extend({initialize:function(){this.model.on("add",this.render,this),this.render()},render:function(){this.$el.empty();var t=e('<table class="sentences table table-striped table-bordered table-condensed"></table>');this.model.each(function(e){new a({model:e,el:t})}),t.appendTo(this.$el),new l({model:this.model,el:this.$el})}}),a=n.View.extend({template:t.template("<td><%= text %></td>"),initialize:function(){this.render()},render:function(){var t=e("<tr></tr>");e(this.template(this.model.toJSON())).appendTo(t),new f({model:this.model,el:t}),t.appendTo(this.$el)}}),f=n.View.extend({initialize:function(){this.render()},render:function(){var t=this,n=this.button();n.click(function(){t.model.send(),n.hide()});var r=e("<td></td>");n.appendTo(r),r.appendTo(this.$el)},button:function(){return this._button===undefined&&(this._button=e("<button class='send btn btn-success'>send</button>")),this._button}}),l=n.View.extend({initialize:function(){this.render()},render:function(){var t=this,n=e("<textarea></textarea>");n.appendTo(this.$el);var r=e("<button class='upload btn btn-success'>upload</button>");r.click(function(){t.model.addAll(n.val())}),r.appendTo(this.$el)}});r.Sentence=i,r.Sentences=s,r.SentenceView=o,r.SentencesView=u}(jQuery,_,Backbone,Electus);